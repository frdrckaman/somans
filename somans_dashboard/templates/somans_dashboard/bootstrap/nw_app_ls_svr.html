{% extends 'somans_dashboard/bootstrap/base.html' %}
{% block title %}
    <title> SOMANS | SERVERS </title>
{% endblock %}
{% block content %}
    <div class="content content--top-nav">
        <div class="intro-y flex items-center mt-8">
            <h2 class="text-lg font-medium mr-auto">
                Newly Installed Software Server
            </h2>
        </div>
        {% if request.GET.response == 'success' %}
            <div class="alert alert-success-soft show flex items-center mb-2" role="alert"> <i data-lucide="thumbs-up" class="w-6 h-6 mr-2"></i> {{ request.GET.message }} </div>
        {% elif request.GET.response == 'error' %}
            <div class="alert alert-danger-soft show flex items-center mb-2" role="alert"> <i data-lucide="alert-octagon" class="w-6 h-6 mr-2"></i> {{ request.GET.message }} </div>
        {% endif %}

        <!-- BEGIN: HTML Table Data -->
        <div class="intro-y box p-5 mt-5">
            <div class="flex flex-col sm:flex-row sm:items-end xl:items-start">
                <form id="tabulator-html-filter-form" class="xl:flex sm:mr-auto" >
                    <div class="sm:flex items-center sm:mr-4">
                        <label class="w-12 flex-none xl:w-auto xl:flex-initial mr-2">Field</label>
                        <select id="tabulator-html-filter-field" class="form-select w-full sm:w-32 2xl:w-full mt-2 sm:mt-0 sm:w-auto">
                            <option value="product_name">Product Name</option>
                        </select>
                    </div>
                    <div class="sm:flex items-center sm:mr-4 mt-2 xl:mt-0">
                        <label class="w-12 flex-none xl:w-auto xl:flex-initial mr-2">Type</label>
                        <select id="tabulator-html-filter-type" class="form-select w-full mt-2 sm:mt-0 sm:w-auto" >
                            <option value="like" selected>like</option>
                            <option value="=">=</option>
                            <option value="<">&lt;</option>
                            <option value="<=">&lt;=</option>
                            <option value=">">></option>
                            <option value=">=">>=</option>
                            <option value="!=">!=</option>
                        </select>
                    </div>
                    <div class="sm:flex items-center sm:mr-4 mt-2 xl:mt-0">
                        <label class="w-12 flex-none xl:w-auto xl:flex-initial mr-2">Value</label>
                        <input id="tabulator-html-filter-value" type="text" class="form-control sm:w-40 2xl:w-full mt-2 sm:mt-0" placeholder="Search...">
                    </div>
{#                    <div class="mt-2 xl:mt-0">#}
{#                        <button id="tabulator-html-filter-go" type="button" class="btn btn-primary w-full sm:w-16" >Go</button>#}
{#                        <input type="reset" id="tabulator-html-filter-reset" class="btn btn-secondary w-full sm:w-16 mt-2 sm:mt-0 sm:ml-1" onclick="clearFunction()" value="Reset">#}
{#                    </div>#}
                </form>
                <div class="flex mt-5 sm:mt-0">
                    <a href="{% url 'somans_dashboard:new-sft-dtls-svr' %}" class="btn btn-outline-secondary w-1/2 sm:w-auto mr-2"> <i data-lucide="list" class="w-4 h-4 mr-2"></i> More Details </a>
                    <button id="tabulator-print" class="btn btn-outline-secondary w-1/2 sm:w-auto mr-2"> <i data-lucide="printer" class="w-4 h-4 mr-2"></i> Print </button>
                    <div class="dropdown w-1/2 sm:w-auto">
                        <button class="dropdown-toggle btn btn-outline-secondary w-full sm:w-auto" aria-expanded="false" data-tw-toggle="dropdown"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export <i data-lucide="chevron-down" class="w-4 h-4 ml-auto sm:ml-2"></i> </button>
                        <div class="dropdown-menu w-40">
                            <ul class="dropdown-content">
                                <li>
                                    <a id="tabulator-export-csv" href="javascript:;" class="dropdown-item"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export CSV </a>
                                </li>
                                <li>
                                    <a id="tabulator-export-json" href="javascript:;" class="dropdown-item"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export JSON </a>
                                </li>
                                <li>
                                    <a id="tabulator-export-xlsx" href="javascript:;" class="dropdown-item"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export XLSX </a>
                                </li>
                                <li>
                                    <a id="tabulator-export-pdf" href="javascript:;"
                                       class="dropdown-item"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export PDF </a>
                                </li>
                                <li>
                                    <a id="tabulator-export-html" href="javascript:;" class="dropdown-item"> <i data-lucide="file-text" class="w-4 h-4 mr-2"></i> Export HTML </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div><br>
            <div class="overflow-x-auto scrollbar-hidden">
                <div id="tabulator1" class="mt-5 table-report table-report--tabulator">
            </div>
        </div>
        <!-- END: HTML Table Data -->
        <!-- END: Content -->
        </div>
    </div>
    <script>

        tabledata = {{ nw_app_svr_ls|safe }}

        var table = new Tabulator("#tabulator1", {
            data:tabledata,
            layout:"fitColumns",
            responsiveLayout:"hide",
            addRowPos:"top",
            history:true,
            pagination:"local",
            paginationSize:20,
            paginationCounter:"rows",
            movableColumns:true,
            initialSort:[
                {column:"product_name", dir:"asc"},
            ],
            columnDefaults:{
                tooltip:true,         //show tool tips on cells
            },
            columns:[                 //define the table columns
                {title:"Product Name", field:"product_name", formatter:"link",
                    formatterParams:{labelField:"product_name", urlPrefix:""}},
            ],
        });
    </script>

    <script>
        //Define variables for input elements
        var fieldEl = document.getElementById("tabulator-html-filter-field");
        var typeEl = document.getElementById("tabulator-html-filter-type");
        var valueEl = document.getElementById("tabulator-html-filter-value");

        //Custom filter example
        function customFilter(data){
            return data.car && data.rating < 3;
        }

        //Trigger setFilter function with correct parameters
        function updateFilter(){
          var filterVal = fieldEl.options[fieldEl.selectedIndex].value;
          var typeVal = typeEl.options[typeEl.selectedIndex].value;

          var filter = filterVal == "function" ? customFilter : filterVal;

          if(filterVal == "function" ){
            typeEl.disabled = true;
            valueEl.disabled = true;
          }else{
            typeEl.disabled = false;
            valueEl.disabled = false;
          }

          if(filterVal){
            table.setFilter(filter,typeVal, valueEl.value);
          }
        }

        //Update filters on value change
        document.getElementById("tabulator-html-filter-field").addEventListener("change", updateFilter);
        document.getElementById("tabulator-html-filter-type").addEventListener("change", updateFilter);
        document.getElementById("tabulator-html-filter-value").addEventListener("keyup", updateFilter);

        //Clear filters on "Clear Filters" button click
        document.getElementById("filter-clear").addEventListener("click", function(){
          fieldEl.value = "";
          typeEl.value = "=";
          valueEl.value = "";

          table.clearFilter();
        });

        //Build Tabulator
        var table = new Tabulator("#tabulator1", {
            height:"311px",
            layout:"fitColumns",
            columns:[                 //define the table columns
                {title:"Product Name", field:"product_name"},
            ],
        });
    </script>

{% endblock %}